name: test pr push

on:
  pull_request:
    branches: [ "master"]

# jobs:
#   run-script:
#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout repository
#       uses: actions/checkout@v3 # Checks out the repository code
#     - name: Display PR Number
#       run: echo "The pull request number is: ${{ github.event.pull_request.number }}"
jobs:
  run-script:
    runs-on: ubuntu-latest
    steps:
    - name: Display PR Number
      run: |
        echo "The pull request number is: ${{ github.event.pull_request.number }}"
        
    - name: Chekout code 
      uses: actions/checkout@v3 
      with:
        fetch-depth: 0

    - name: check for changes in the python file
      run: | 
          diff_docker_file=$(git diff --name-only origin/master...HEAD | grep -E '^.*py$' || echo "")
          diff_requirements_txt=$(git diff --name-only origin/master...HEAD | grep -E '^.*Dockerfile$' || echo "")
          echo $(pwd)
          if [ -z "$diff_docker_file" ] && [ -z "$diff_requirements_txt" ]; then
            echo "No change made to the Dockerfile and the requirements.txt file."
          
          elif [ -z "$diff_docker_file" ] && [ -n "$diff_requirements_txt" ]; then
            echo "Changes made to the requirements.txt file:"
            for file in $diff_requirements_txt; do 
              echo "inside the file loop"
              echo $file
              IFS='/ ' read -r -a array <<< $file
              echo "${array[0]}"
              done 

          elif [ -n "$diff_docker_file" ] && [ -z "$diff_requirements_txt" ]; then
            echo "Changes made to the dockerfile:"
            for file in $diff_docker_file; do 
              echo "inside the file loop"
              echo $file
              IFS='/ ' read -r -a array <<< $file
              echo "${array[0]}"
            done

          else
            
            echo "ignoring things"
              
          fi
